@(dinners: List[Dinner], allOrders: Map[ObjectId, List[Order]], orderForm: Form[Order])

@import helper._
@import helper.twitterBootstrap2._ 
@import java.util.Date

@implicitFieldConstructor = @{FieldConstructor(simpleForm.f)}

@main("Feed Me!") {
    
    @if(dinners.size > 0) {
    	@dinners.map { dinner =>
    		<div class="well">
                @if(dinner.dinner_time.getDate() == new Date().getDate()){
                    <h3>@dinner.name kl @dinner.dinner_time.format("HH:mm")</h3>
                    <p>@dinner.description</p>
                    <p>@dinner.id Bestil inden @dinner.order_latest_time.format("HH:mm") fra <a target="_blank" href="@dinner.restaurant_link">@dinner.restaurant_name</a></p>
                } else {
                    <h3>@dinner.name @dinner.dinner_time.format("dd/MM-yyyy HH:mm")</h3>
                    <p>@dinner.description</p>
                    <p>Bestil inden @dinner.order_latest_time.format("dd/MM-yyyy HH:mm") fra <a target="_blank" href="@dinner.restaurant_link">@dinner.restaurant_name</a></p>
                }
                
                @if(dinner.open){
                    @helper.form(routes.Application.addOrder(dinner.id), 'class -> "form-inline"){
                        <table class="table table-bordered table-striped responsive-utilities">
                            <tr>
                                <th>Navn</th>
                                <th>Nr</th>
                                <th>Kommentar</th>
                                <th></th>
                            </tr>

                        @allOrders.get(dinner.id).get.map { order =>
                            <tr>
                                <td>@order.name</td>
                                <td>@order.food_number</td>
                                <td>@order.comment</td>
                                <td><a href='@routes.Application.deleteOrder(order.id)' class='btn btn-danger'>Slet</a></td>
                            </tr>
                        }
                            <tr>
                                <td>
                                    @helper.input(orderForm("name"), '_label -> "") { (id, name, value, args) =>
                                        <input type="text" name="@name" id="@id" @toHtmlArgs(args) placeholder='Dit navn'>
                                    } 
                                </td>
                                <td>
                                    @helper.input(orderForm("food_number"), '_label -> "", '_help -> "") { (id, name, value, args) =>
                                        <input type="text" name="@name" id="@id" @toHtmlArgs(args) placeholder='Nr'>
                                    } 
                                </td>
                                <td>
                                    @helper.input(orderForm("comment"), '_label -> "") { (id, name, value, args) =>
                                        <input type="text" name="@name" id="@id" @toHtmlArgs(args) placeholder='Kommentar'>
                                    } 
                                </td>
                                <td><input type='submit' value='Bestil' class='btn btn-primary'></td>
                            </tr>
                        </table>
                    }
                }
                
    		</div>
    	}
        <a class="btn btn-primary" href="@routes.DinnerController.newDinner">Ny bestilling</a>	
    } else {
        <div class="hero-unit">
            <h1>Ingen bestillinger</h1>
            <p>Der er pt ingen bestillinger åbne. Er du sulten så opret en nu!</p>
            <a class="btn btn-primary btn-large" href="@routes.DinnerController.newDinner">
                Ny bestilling
            </a>
        </div>
    }
    
}